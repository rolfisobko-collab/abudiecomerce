(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4005],{8868:(e,s,t)=>{Promise.resolve().then(t.bind(t,4890))},4890:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>h});var r=t(5155),a=t(2115),l=t(6046);t(6962);var n=t(3805),i=t(2651),o=t(5037);let c=()=>{let{currency:e,router:s,getCartCount:t,getCartAmount:l,getToken:c,user:d,cartItems:x,setCartItems:m}=(0,n.U)(),[h,u]=(0,a.useState)(null),[p,g]=(0,a.useState)(!1),[f,j]=(0,a.useState)([]),[y,b]=(0,a.useState)([]),[N,v]=(0,a.useState)(null),[w,k]=(0,a.useState)(""),[C,A]=(0,a.useState)(!1),P=async()=>{try{let e=await c(),{data:s}=await i.A.get("/api/user/get-address",{headers:{Authorization:"Bearer ".concat(e)}});s.success?(j(s.addresses),s.addresses.length>0&&u(s.addresses[0])):o.Ay.error(s.message)}catch(e){o.Ay.error(e.message)}},_=async()=>{try{let{data:e}=await i.A.get("/api/payment-methods");e.success?(b(e.paymentMethods),e.paymentMethods.length>0&&v(e.paymentMethods[0])):o.Ay.error(e.message)}catch(e){o.Ay.error("Error al cargar medios de pago")}},Q=e=>{u(e),g(!1)},M=async()=>{try{if(!d)return(0,o.Ay)("Por favor inicia sesi\xf3n para realizar el pedido",{icon:"⚠️"});if(!h)return o.Ay.error("Por favor selecciona una direcci\xf3n");if(!N)return o.Ay.error("Por favor selecciona un medio de pago");if(!w.trim())return o.Ay.error("Por favor ingresa el comprobante de pago o hash de transacci\xf3n");let e=Object.keys(x).map(e=>({product:e,quantity:x[e]}));if(e=e.filter(e=>e.quantity>0),0===e.length)return o.Ay.error("El carrito est\xe1 vac\xedo");let t=await c(),{data:r}=await i.A.post("/api/order/create",{address:h._id,items:e,paymentMethod:N._id,paymentProof:w},{headers:{Authorization:"Bearer ".concat(t)}});r.success?(o.Ay.success(r.message),m({}),s.push("/order-placed")):o.Ay.error(r.message)}catch(e){o.Ay.error(e.message)}};return(0,a.useEffect)(()=>{d&&(P(),_())},[d]),(0,r.jsxs)("div",{className:"w-full md:w-96 bg-gray-500/5 p-5",children:[(0,r.jsx)("h2",{className:"text-xl md:text-2xl font-medium text-gray-700",children:"Resumen del Pedido"}),(0,r.jsx)("hr",{className:"border-gray-500/30 my-5"}),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-base font-medium uppercase text-gray-600 block mb-2",children:"Seleccionar Direcci\xf3n"}),(0,r.jsxs)("div",{className:"relative inline-block w-full text-sm border",children:[(0,r.jsxs)("button",{className:"peer w-full text-left px-4 pr-2 py-2 bg-white text-gray-700 focus:outline-none",onClick:()=>g(!p),children:[(0,r.jsx)("span",{children:h?"".concat(h.fullName,", ").concat(h.area,", ").concat(h.city,", ").concat(h.state):"Seleccionar Direcci\xf3n"}),(0,r.jsx)("svg",{className:"w-5 h-5 inline float-right transition-transform duration-200 ".concat(p?"rotate-0":"-rotate-90"),xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"#6B7280",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})]}),p&&(0,r.jsxs)("ul",{className:"absolute w-full bg-white border shadow-md mt-1 z-10 py-1.5",children:[f.map((e,s)=>(0,r.jsxs)("li",{className:"px-4 py-2 hover:bg-gray-500/10 cursor-pointer",onClick:()=>Q(e),children:[e.fullName,", ",e.area,", ",e.city,", ",e.state]},s)),(0,r.jsx)("li",{onClick:()=>s.push("/add-address"),className:"px-4 py-2 hover:bg-gray-500/10 cursor-pointer text-center",children:"+ Agregar Nueva Direcci\xf3n"})]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-base font-medium uppercase text-gray-600 block mb-2",children:"Medio de Pago"}),(0,r.jsx)("div",{className:"relative inline-block w-full text-sm border",children:(0,r.jsxs)("select",{value:(null==N?void 0:N._id)||"",onChange:e=>{let s=y.find(s=>s._id===e.target.value);v(s),A(!!s),k("")},className:"peer w-full text-left px-4 pr-2 py-2 bg-white text-gray-700 focus:outline-none",children:[(0,r.jsx)("option",{value:"",children:"Definir medio de pago"}),y.map(e=>(0,r.jsxs)("option",{value:e._id,children:[e.name," (",e.category," - ",e.currency,")"]},e._id))]})}),N&&(0,r.jsxs)("div",{className:"mt-3 space-y-3",children:[(0,r.jsxs)("div",{className:"p-4 bg-gray-50 rounded-md",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,r.jsx)("span",{className:"px-2 py-1 rounded text-xs font-medium ".concat("BANK_TRANSFER"===N.type?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"),children:N.category}),(0,r.jsx)("span",{className:"text-sm text-gray-600",children:N.currency})]}),(0,r.jsxs)("div",{className:"text-sm space-y-1",children:["BANK_TRANSFER"===N.type&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Banco:"})," ",N.bankName]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Cuenta:"})," ",N.accountNumber]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Titular:"})," ",N.accountHolder]}),N.cbu&&(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"CBU:"})," ",(0,r.jsx)("span",{className:"font-mono text-xs",children:N.cbu})]}),N.pix&&(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"PIX:"})," ",(0,r.jsx)("span",{className:"font-mono text-xs",children:N.pix})]})]}),"CRYPTO"===N.type&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Wallet:"})," ",(0,r.jsx)("span",{className:"font-mono text-xs break-all",children:N.walletAddress})]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Red:"})," ",N.network]})]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Instrucciones:"})," ",N.instructions]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Procesamiento:"})," ",N.processingTime]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Comprobante de Pago / Hash de Transacci\xf3n"}),(0,r.jsx)("textarea",{value:w,onChange:e=>k(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-[#feecaf] focus:border-transparent outline-none",placeholder:"CRYPTO"===N.type?"Ingresa el hash de la transacci\xf3n (ej: 0x1234...)":"Ingresa el n\xfamero de comprobante o referencia de la transferencia",rows:2,required:!0}),(0,r.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"CRYPTO"===N.type?"Copia y pega el hash de la transacci\xf3n desde tu wallet":"Ingresa el n\xfamero de comprobante que te proporcion\xf3 el banco"})]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-base font-medium uppercase text-gray-600 block mb-2",children:"C\xf3digo Promocional"}),(0,r.jsxs)("div",{className:"flex flex-col items-start gap-3",children:[(0,r.jsx)("input",{type:"text",placeholder:"Ingresa c\xf3digo promocional",className:"flex-grow w-full outline-none p-2.5 text-gray-600 border"}),(0,r.jsx)("button",{className:"bg-[#feecaf] text-black px-9 py-2 hover:bg-[#feecaf]/80",children:"Aplicar"})]})]}),(0,r.jsx)("hr",{className:"border-gray-500/30 my-5"}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex justify-between text-base font-medium",children:[(0,r.jsxs)("p",{className:"uppercase text-gray-600",children:["Art\xedculos ",t()]}),(0,r.jsxs)("p",{className:"text-gray-800",children:[e,l()]})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("p",{className:"text-gray-600",children:"Costo de Env\xedo"}),(0,r.jsx)("p",{className:"font-medium text-gray-800",children:"Gratis"})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("p",{className:"text-gray-600",children:"Impuesto (2%)"}),(0,r.jsxs)("p",{className:"font-medium text-gray-800",children:[e,Math.floor(.02*l())]})]}),(0,r.jsxs)("div",{className:"flex justify-between text-lg md:text-xl font-medium border-t pt-3",children:[(0,r.jsx)("p",{children:"Total"}),(0,r.jsxs)("p",{children:[e,l()+Math.floor(.02*l())]})]})]})]}),(0,r.jsx)("button",{onClick:M,className:"w-full bg-[#feecaf] text-black py-3 mt-5 hover:bg-[#feecaf]/80",children:"Realizar Pedido"})]})};var d=t(5565),x=t(3996);let m=()=>{let e=(0,l.useSearchParams)(),{products:s,router:t,cartItems:i,addToCart:o,updateCartQuantity:m,getCartCount:h,setCartItems:u,generateCartShareUrl:p}=(0,n.U)();return(0,a.useEffect)(()=>{let t=e.get("products");if(t&&s.length>0)try{let e=t.split(","),r={};e.forEach(e=>{let[t,a]=e.split(":");t&&a&&!isNaN(parseInt(a))&&s.find(e=>e._id===t)&&(r[t]=parseInt(a))}),Object.keys(r).length>0&&u(r)}catch(e){console.error("Error al parsear productos de la URL:",e)}},[e,s,u]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(x.A,{}),(0,r.jsxs)("div",{className:"relative min-h-screen",children:[(0,r.jsx)("div",{className:"absolute inset-0 bg-gradient-to-br from-gray-50 via-white to-gray-100"}),(0,r.jsxs)("div",{className:"absolute top-0 left-0 w-full h-full overflow-hidden pointer-events-none",children:[(0,r.jsx)("div",{className:"absolute top-20 left-10 w-72 h-72 bg-gradient-to-br from-[#feecaf]/20 to-yellow-300/20 rounded-full blur-3xl animate-pulse"}),(0,r.jsx)("div",{className:"absolute top-40 right-20 w-96 h-96 bg-gradient-to-br from-purple-200/20 to-pink-200/20 rounded-full blur-3xl animate-pulse",style:{animationDelay:"2s"}})]}),(0,r.jsx)("div",{className:"relative z-10",children:(0,r.jsxs)("div",{className:"px-6 md:px-16 lg:px-32 pt-8 pb-16",children:[(0,r.jsxs)("div",{className:"text-center mb-12",children:[(0,r.jsxs)("div",{className:"inline-flex items-center gap-2 bg-gradient-to-r from-[#feecaf] to-yellow-300 text-gray-800 px-4 py-2 rounded-full text-sm font-semibold mb-4",children:[(0,r.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 3h2l.4 2M7 13h10l4-8H5.4m0 0L7 13m0 0l-2.5 5M7 13l2.5 5m6-5v6a2 2 0 01-2 2H9a2 2 0 01-2-2v-6m8 0V9a2 2 0 00-2-2H9a2 2 0 00-2 2v4.01"})}),"Tu Carrito de Compras"]}),(0,r.jsxs)("h1",{className:"text-4xl font-bold text-gray-900 mb-4",children:["Mi ",(0,r.jsx)("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-[#feecaf] to-yellow-300",children:"Carrito"})]}),(0,r.jsx)("p",{className:"text-gray-600 max-w-2xl mx-auto text-lg",children:"Revisa tus productos seleccionados y procede al checkout"})]}),(0,r.jsxs)("div",{className:"flex flex-col lg:flex-row gap-8",children:[(0,r.jsx)("div",{className:"flex-1",children:(0,r.jsxs)("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl shadow-xl border border-gray-200/50 p-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,r.jsxs)("h2",{className:"text-xl font-semibold text-gray-900",children:["Productos (",h()," art\xedculos)"]}),h()>0&&(0,r.jsxs)("button",{onClick:()=>{let e=p();e&&(navigator.clipboard.writeText(e),alert("\xa1URL del carrito copiada al portapapeles!"))},className:"px-4 py-2 bg-gradient-to-r from-blue-500 to-indigo-500 text-white rounded-xl hover:from-blue-600 hover:to-indigo-600 transition-all duration-300 text-sm font-medium flex items-center gap-2",children:[(0,r.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.367 2.684 3 3 0 00-5.367-2.684z"})}),"Compartir"]})]}),(0,r.jsx)("div",{className:"space-y-4",children:Object.keys(i).map(e=>{let t=s.find(s=>s._id===e);return!t||i[e]<=0?null:(0,r.jsx)("div",{className:"bg-white border border-gray-200/50 rounded-2xl p-6 shadow-lg hover:shadow-xl transition-all duration-300",children:(0,r.jsxs)("div",{className:"flex items-center gap-6",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)("div",{className:"w-20 h-20 bg-gradient-to-br from-gray-50 to-gray-100 rounded-xl overflow-hidden",children:t.image&&t.image[0]?(0,r.jsx)(d.default,{src:t.image[0],alt:t.name,className:"w-full h-full object-cover",width:80,height:80}):(0,r.jsx)(d.default,{src:"/placeholder-product.jpeg",alt:t.name,width:80,height:80,className:"w-full h-full object-cover"})})}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-1 truncate",children:t.name}),(0,r.jsx)("p",{className:"text-sm text-gray-600 mb-2 line-clamp-2",children:t.description}),(0,r.jsxs)("div",{className:"flex items-center gap-4 mb-3",children:[(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsxs)("span",{className:"text-lg font-bold ".concat(i[e]>=(t.minQuantity&&t.minQuantity>0?t.minQuantity:1)?"text-green-600":"text-gray-900"),children:["$",i[e]>=(t.minQuantity&&t.minQuantity>0?t.minQuantity:1)?t.offerPrice:t.price]}),i[e]>=(t.minQuantity&&t.minQuantity>0?t.minQuantity:1)&&(0,r.jsx)("span",{className:"text-xs text-green-600 font-medium",children:"Precio Mayorista"}),i[e]<(t.minQuantity&&t.minQuantity>0?t.minQuantity:1)&&(0,r.jsxs)("span",{className:"text-xs text-gray-500",children:["Necesitas ",(t.minQuantity&&t.minQuantity>0?t.minQuantity:1)-i[e]," m\xe1s para precio mayorista"]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("button",{onClick:()=>m(t._id,i[e]-1),className:"w-8 h-8 bg-gray-100 hover:bg-gray-200 rounded-full flex items-center justify-center transition-colors",children:(0,r.jsx)("svg",{className:"w-4 h-4 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 12H4"})})}),(0,r.jsx)("input",{onChange:e=>m(t._id,Number(e.target.value)),type:"number",value:i[e],className:"w-12 h-8 border border-gray-200 rounded-lg text-center text-sm font-medium focus:outline-none focus:ring-2 focus:ring-[#feecaf]"}),(0,r.jsx)("button",{onClick:()=>o(t._id),className:"w-8 h-8 bg-gray-100 hover:bg-gray-200 rounded-full flex items-center justify-center transition-colors",children:(0,r.jsx)("svg",{className:"w-4 h-4 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})})]})]})]}),(0,r.jsxs)("div",{className:"flex flex-col items-end gap-3",children:[(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsxs)("p",{className:"text-lg font-bold text-gray-900",children:["$",((i[e]>=(t.minQuantity&&t.minQuantity>0?t.minQuantity:1)?t.offerPrice:t.price)*i[e]).toFixed(2)]}),(0,r.jsx)("p",{className:"text-xs text-gray-500",children:"Subtotal"})]}),(0,r.jsx)("button",{onClick:()=>m(t._id,0),className:"px-3 py-1 text-red-600 hover:text-red-700 hover:bg-red-50 rounded-lg transition-colors text-sm font-medium",children:"Eliminar"})]})]})},e)})}),(0,r.jsxs)("button",{onClick:()=>t.push("/all-products"),className:"group flex items-center mt-6 gap-2 text-[#feecaf] hover:text-yellow-300 transition-colors",children:[(0,r.jsx)("svg",{className:"w-4 h-4 group-hover:-translate-x-1 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Continuar Comprando"]})]})}),(0,r.jsx)("div",{className:"lg:w-96",children:(0,r.jsx)(c,{})})]})]})})]})]})},h=()=>(0,r.jsx)(a.Suspense,{fallback:(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-[#feecaf]"})}),children:(0,r.jsx)(m,{})})}},e=>{var s=s=>e(e.s=s);e.O(0,[6711,5037,2651,3060,5565,8007,6962,3996,8441,1517,7358],()=>s(8868)),_N_E=e.O()}]);