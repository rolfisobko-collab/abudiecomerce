(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8624],{102:(e,t,a)=>{Promise.resolve().then(a.bind(a,2400))},2400:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>i});var s=a(5155),r=a(2115);a(6962),a(5565);var o=a(3805),l=a(1598),n=a(2651),c=a(5037);let i=()=>{let{currency:e,getToken:t,user:a}=(0,o.U)(),[i,d]=(0,r.useState)([]),[u,m]=(0,r.useState)([]),[g,h]=(0,r.useState)(!0),[p,x]=(0,r.useState)("todos"),f=async()=>{console.log("\uD83D\uDD0D [ORDERS DEBUG] Iniciando fetchSellerOrders...");try{console.log("\uD83D\uDD0D [ORDERS DEBUG] Haciendo petici\xf3n a /api/order/seller-orders...");let{data:e}=await n.A.get("/api/order/seller-orders",{withCredentials:!0});console.log("\uD83D\uDD0D [ORDERS DEBUG] Respuesta recibida:",e),e.success?(console.log("\uD83D\uDD0D [ORDERS DEBUG] \xc9xito, \xf3rdenes:",e.orders.length),d(e.orders)):(console.log("\uD83D\uDD0D [ORDERS DEBUG] Error en respuesta:",e.message),c.Ay.error(e.message)),h(!1)}catch(e){console.log("\uD83D\uDD0D [ORDERS DEBUG] Error en catch:",e.message),c.Ay.error(e.message),h(!1)}},y=(e,t)=>{if("todos"===t)return e;let a={pendiente:"Order Placed",en_procesado:"Processing",en_camino:"Shipped",entregado:"Delivered"}[t]||t;return e.filter(e=>(e.status||"Order Placed")===a)};return(0,r.useEffect)(()=>{m(y(i,p))},[i,p]),(0,r.useEffect)(()=>{f()},[]),(0,s.jsx)("div",{className:"flex-1 h-screen overflow-scroll flex flex-col justify-between text-sm",children:g?(0,s.jsx)("div",{className:"flex-1 flex items-center justify-center",children:(0,s.jsx)(l.A,{})}):(0,s.jsxs)("div",{className:"md:p-10 p-4 space-y-5",children:[(0,s.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[(0,s.jsx)("h2",{className:"text-lg font-medium",children:"Pedidos"}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Filtrar por estado:"}),(0,s.jsxs)("select",{value:p,onChange:e=>x(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-[#feecaf] focus:border-transparent outline-none text-sm bg-white",children:[(0,s.jsx)("option",{value:"todos",children:"Todos"}),(0,s.jsx)("option",{value:"pendiente",children:"\uD83D\uDFE1 Order Placed"}),(0,s.jsx)("option",{value:"en_procesado",children:"\uD83D\uDFE0 Processing"}),(0,s.jsx)("option",{value:"en_camino",children:"\uD83D\uDE9A Shipped"}),(0,s.jsx)("option",{value:"entregado",children:"✅ Delivered"})]})]})]}),(0,s.jsx)("div",{className:"bg-[#feecaf]/10 border border-[#feecaf] rounded-lg p-3",children:(0,s.jsxs)("p",{className:"text-sm text-gray-700",children:["Mostrando ",(0,s.jsx)("span",{className:"font-semibold text-[#feecaf]",children:u.length})," de ",(0,s.jsx)("span",{className:"font-semibold",children:i.length})," pedidos"]})}),(0,s.jsx)("div",{className:"max-w-4xl rounded-md",children:0===u.length?(0,s.jsxs)("div",{className:"text-center py-8",children:[(0,s.jsx)("div",{className:"w-16 h-16 mx-auto mb-4 bg-gray-100 rounded-full flex items-center justify-center",children:(0,s.jsx)("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"})})}),(0,s.jsx)("p",{className:"text-gray-500",children:0===i.length?"No hay \xf3rdenes a\xfan":"No hay pedidos con el estado seleccionado"})]}):u.map((t,a)=>{var r;return(0,s.jsxs)("div",{className:"flex flex-col md:flex-row gap-5 justify-between p-5 border border-gray-200 rounded-lg bg-white shadow-sm hover:shadow-md transition-shadow",children:[(0,s.jsxs)("div",{className:"flex-1 flex gap-5 max-w-80",children:[(0,s.jsx)("div",{className:"flex-shrink-0 w-16 h-16 bg-[#feecaf]/20 rounded-lg flex items-center justify-center",children:(0,s.jsxs)("svg",{className:"w-8 h-8 text-[#feecaf]",fill:"currentColor",viewBox:"0 0 24 24",children:[(0,s.jsx)("path",{d:"M7 4V2C7 1.45 7.45 1 8 1H16C16.55 1 17 1.45 17 2V4H20C20.55 4 21 4.45 21 5S20.55 6 20 6H19V19C19 20.1 18.1 21 17 21H7C5.9 21 5 20.1 5 19V6H4C3.45 6 3 5.55 3 5S3.45 4 4 4H7ZM9 3V4H15V3H9ZM7 6V19H17V6H7Z",fill:"#feecaf"}),(0,s.jsx)("path",{d:"M9 8V17H11V8H9ZM13 8V17H15V8H13Z",fill:"#feecaf"})]})}),(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,s.jsx)("span",{className:"font-medium text-gray-900",children:t.items.map(e=>e.product.name+" x ".concat(e.quantity)).join(", ")}),(0,s.jsxs)("span",{className:"text-sm text-gray-600",children:["Art\xedculos: ",t.items.length]}),(0,s.jsxs)("span",{className:"text-xs text-gray-500",children:["ID: ",null===(r=t._id)||void 0===r?void 0:r.substring(0,8),"..."]})]})]}),(0,s.jsx)("div",{children:(0,s.jsxs)("p",{children:[(0,s.jsx)("span",{className:"font-medium",children:t.address.fullName}),(0,s.jsx)("br",{}),(0,s.jsx)("span",{children:t.address.area}),(0,s.jsx)("br",{}),(0,s.jsx)("span",{children:"".concat(t.address.city,", ").concat(t.address.state)}),(0,s.jsx)("br",{}),(0,s.jsx)("span",{children:t.address.phoneNumber})]})}),(0,s.jsxs)("p",{className:"font-medium my-auto",children:[e,t.amount]}),(0,s.jsx)("div",{children:(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,s.jsxs)("p",{className:"flex flex-col",children:[(0,s.jsx)("span",{children:"M\xe9todo : Contra Entrega"}),(0,s.jsxs)("span",{children:["Fecha : ",new Date(t.date).toLocaleDateString()]}),(0,s.jsxs)("span",{children:["Pago : ",t.paymentMethod?"".concat(t.paymentMethod.name," (").concat(t.paymentMethod.category,")"):"Pendiente"]}),t.paymentProof&&(0,s.jsxs)("span",{className:"text-xs text-gray-500",children:["Comprobante: ",t.paymentProof.substring(0,20),"..."]})]}),(0,s.jsxs)("div",{className:"mt-2",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Estado del Pedido:"}),(0,s.jsxs)("select",{value:t.status||"Order Placed",onChange:async e=>{let a=e.target.value;try{if((await n.A.put("/api/order/update-status",{orderId:t._id,status:a},{withCredentials:!0})).data.success){let e=i.map(e=>e._id===t._id?{...e,status:a}:e);d(e),c.Ay.success("Estado actualizado a: ".concat(a))}}catch(e){console.error("Error al actualizar estado:",e),c.Ay.error("Error al actualizar el estado")}},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-[#feecaf] focus:border-transparent outline-none text-sm bg-white",children:[(0,s.jsx)("option",{value:"Order Placed",children:"\uD83D\uDFE1 Order Placed"}),(0,s.jsx)("option",{value:"Processing",children:"\uD83D\uDFE0 Processing"}),(0,s.jsx)("option",{value:"Shipped",children:"\uD83D\uDE9A Shipped"}),(0,s.jsx)("option",{value:"Delivered",children:"✅ Delivered"})]})]})]})})]},a)})})]})})}},1598:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});var s=a(5155);a(2115);let r=()=>(0,s.jsx)("div",{className:"flex justify-center items-center h-[70vh]",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-20 w-20 border-4 border-t-[#feecaf] border-gray-200"})})},3805:(e,t,a)=>{"use strict";a.d(t,{AppContextProvider:()=>u,U:()=>d});var s=a(5155),r=a(2615),o=a(2651),l=a(6046),n=a(2115),c=a(5037);let i=(0,n.createContext)(),d=()=>(0,n.useContext)(i),u=e=>{let t=(0,l.useRouter)(),{data:a,status:d}=(0,r.useSession)(),u=null==a?void 0:a.user,m=async()=>{try{if(!a)return console.log("No hay sesi\xf3n activa"),null;return"authenticated"}catch(e){return console.error("Error getting token:",e),null}},[g,h]=(0,n.useState)([]),[p,x]=(0,n.useState)([]),[f,y]=(0,n.useState)(!1),[N,j]=(0,n.useState)(!1),[D,E]=(0,n.useState)({}),[v,b]=(0,n.useState)(!0),w=async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];try{if(b(!0),!e){let e=localStorage.getItem("quickcart_products"),t=localStorage.getItem("quickcart_products_timestamp");if(e&&t&&Date.now()-parseInt(t)<6e5){console.log("\uD83D\uDCE6 Cargando productos desde localStorage"),h(JSON.parse(e)),b(!1),S();return}}await S()}catch(e){console.error("Error loading products:",e),c.Ay.error("Error al cargar productos"),b(!1)}},S=async()=>{try{console.log("\uD83C\uDF10 Cargando productos desde Atlas (API)");let{data:e}=await o.A.get("/api/product/list",{timeout:1e4});if(e.success){let t=e.products.map(e=>({...e,minQuantity:e.minWholesaleQuantity&&e.minWholesaleQuantity>0?e.minWholesaleQuantity:1,image:e.image&&e.image.length>0&&e.image[0]&&""!==e.image[0]?e.image:["/placeholder-product.jpeg"]}));h(t),setTimeout(()=>{localStorage.setItem("quickcart_products",JSON.stringify(t)),localStorage.setItem("quickcart_products_timestamp",Date.now().toString()),console.log("\uD83D\uDCBE Productos guardados en localStorage (Atlas)")},0)}else c.Ay.error(e.message)}catch(e){console.error("Error fetching products from Atlas API:",e),c.Ay.error("Error al cargar productos desde Atlas")}finally{b(!1)}},A=async()=>{try{let{data:e}=await o.A.get("/api/categories");e.success&&x(e.categories)}catch(e){console.error("Error fetching categories:",e)}},O=async()=>{try{if(console.log("\uD83D\uDD0D [FRONTEND DEBUG] Iniciando fetchUserData..."),console.log("\uD83D\uDD0D [FRONTEND DEBUG] Usuario de NextAuth:",u?{id:u.id,email:u.email,role:u.role}:"No hay usuario"),!u){console.log("❌ [FRONTEND DEBUG] No hay usuario autenticado");return}console.log("\uD83D\uDD0D [FRONTEND DEBUG] Haciendo petici\xf3n a /api/user/data...");let{data:e}=await o.A.get("/api/user/data");console.log("\uD83D\uDD0D [FRONTEND DEBUG] Respuesta del servidor:",e),e.success?(console.log("✅ [FRONTEND DEBUG] Usuario encontrado exitosamente en la base de datos"),y(e.user),E(e.user.cartItems)):(console.log("❌ [FRONTEND DEBUG] Error del servidor:",e.message),c.Ay.error(e.message))}catch(e){console.log("❌ [FRONTEND DEBUG] Error en fetchUserData:",e.message),console.log("\uD83D\uDD0D [FRONTEND DEBUG] Error completo:",e),c.Ay.error(e.message)}},R=async e=>{if(!u)return(0,c.Ay)("Please login",{icon:"⚠️"});let t=structuredClone(D);if(t[e]?t[e]+=1:t[e]=1,E(t),u)try{await o.A.post("/api/cart/update",{cartData:t}),c.Ay.success("Item added to cart")}catch(e){c.Ay.error(e.message)}},C=async(e,t)=>{let a=structuredClone(D);if(0===t?delete a[e]:a[e]=t,E(a),u)try{await o.A.post("/api/cart/update",{cartData:a}),c.Ay.success("Cart Updated")}catch(e){c.Ay.error(e.message)}};(0,n.useEffect)(()=>{w(),A()},[]),(0,n.useEffect)(()=>{console.log("\uD83D\uDD0D [FRONTEND DEBUG] useEffect ejecutado - usuario cambi\xf3:",u?{id:u.id,email:u.email,role:u.role}:"No hay usuario"),u?(console.log("\uD83D\uDD0D [FRONTEND DEBUG] Usuario detectado, llamando fetchUserData..."),O()):(console.log("\uD83D\uDD0D [FRONTEND DEBUG] No hay usuario, limpiando datos..."),y(!1),j(!1),E({}))},[u]);let U={user:u,signOut:r.signOut,getToken:m,currency:"$",router:t,isSeller:N,setIsSeller:j,userData:f,fetchUserData:O,products:g,fetchProductData:w,categories:p,fetchCategories:A,getCategoryName:e=>{if(!e||!p.length)return"Sin categor\xeda";let t=p.find(t=>t._id===e);return t?t.name:"Sin categor\xeda"},updateProductRating:(e,t,a)=>{h(s=>s.map(s=>s._id===e?{...s,averageRating:t,totalRatings:a}:s))},isLoadingProducts:v,cartItems:D,setCartItems:E,addToCart:R,updateCartQuantity:C,getCartCount:()=>{let e=0;for(let t in D)D[t]>0&&(e+=D[t]);return e},getCartAmount:()=>{let e=0;for(let t in D){let a=g.find(e=>e._id===t);if(D[t]>0&&a){let s=a.minQuantity&&a.minQuantity>0?a.minQuantity:1;e+=(D[t]>=s?a.offerPrice:a.price)*D[t]}}return Math.floor(100*e)/100},generateCartShareUrl:()=>{let e=Object.entries(D).filter(e=>{let[t,a]=e;return a>0});if(0===e.length)return null;let t=e.map(e=>{let[t,a]=e;return"".concat(t,":").concat(a)}).join(",");return"".concat(window.location.origin,"/cart?products=").concat(encodeURIComponent(t))}};return(0,s.jsx)(i.Provider,{value:U,children:e.children})}}},e=>{var t=t=>e(e.s=t);e.O(0,[5037,2651,3060,5565,6962,8441,1517,7358],()=>t(102)),_N_E=e.O()}]);