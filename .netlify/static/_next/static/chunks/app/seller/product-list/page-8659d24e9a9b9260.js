(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7807],{3686:()=>{},2383:()=>{},7347:(e,a,t)=>{Promise.resolve().then(t.bind(t,119))},119:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>x});var r=t(5155),s=t(2115),o=t(6962),l=t(5565),c=t(3805),n=t(1598),i=t(2651),d=t(5037),m=t(7660),u=t(6702),p=t(648);let x=()=>{let{router:e,user:a}=(0,c.U)(),[t,x]=(0,s.useState)([]),[g,h]=(0,s.useState)(!0),[f,y]=(0,s.useState)(null),[b,j]=(0,s.useState)({}),[N,v]=(0,s.useState)([]),[w,C]=(0,s.useState)(""),[E,P]=(0,s.useState)([]),[S,A]=(0,s.useState)(!1),[k,_]=(0,s.useState)(!1),[D,M]=(0,s.useState)(""),[U,I]=(0,s.useState)(""),[T,B]=(0,s.useState)([]),[O,R]=(0,s.useState)([]),[W,F]=(0,s.useState)(1),[G]=(0,s.useState)(10),[L,Q]=(0,s.useState)([]),[z,q]=(0,s.useState)(!1),$=async()=>{console.log("\uD83D\uDD0D [PRODUCT LIST DEBUG] Iniciando fetchSellerProduct...");try{console.log("\uD83D\uDD0D [PRODUCT LIST DEBUG] Haciendo petici\xf3n a /api/product/seller-list...");let{data:a}=await i.A.get("/api/product/seller-list",{withCredentials:!0});console.log("\uD83D\uDD0D [PRODUCT LIST DEBUG] Respuesta recibida:",a),a.success?(console.log("\uD83D\uDD0D [PRODUCT LIST DEBUG] \xc9xito, productos:",a.products.length),x(a.products)):(console.log("\uD83D\uDD0D [PRODUCT LIST DEBUG] Error en respuesta:",a.message),a.redirect?e.push(a.redirect):d.Ay.error(a.message)),h(!1)}catch(r){var a,t;console.log("\uD83D\uDD0D [PRODUCT LIST DEBUG] Error en catch:",r.message),(null===(t=r.response)||void 0===t?void 0:null===(a=t.data)||void 0===a?void 0:a.redirect)?e.push(r.response.data.redirect):d.Ay.error(r.message),h(!1)}},H=e=>{y(e._id),j({name:e.name,category:e.category,brand:e.brand||"",price:e.price,offerPrice:e.offerPrice,minWholesaleQuantity:void 0!==e.minWholesaleQuantity?e.minWholesaleQuantity:"",description:e.description,image:e.image.join(", ")}),v([])},V=async e=>{try{let a={...b};if(N.length>0){let e=new FormData;N.forEach(a=>{e.append("images",a)});let t=await i.A.post("/api/product/upload-images",e,{headers:{"Content-Type":"multipart/form-data"}});if(t.data.success){let e=b.image?b.image.split(",").map(e=>e.trim()).filter(e=>e):[];a.image=[...e,...t.data.images].join(", ")}}let t=await i.A.put("/api/product/update/".concat(e),a);t.data.success?(d.Ay.success("Producto actualizado exitosamente"),y(null),j({}),v([]),$()):d.Ay.error(t.data.message)}catch(e){d.Ay.error("Error al actualizar el producto"),console.error("Error:",e)}},J=async e=>{if(confirm("\xbfEst\xe1s seguro de que quieres eliminar este producto?"))try{let a=await i.A.delete("/api/product/delete/".concat(e),{withCredentials:!0});a.data.success?(d.Ay.success("Producto eliminado exitosamente"),$()):d.Ay.error(a.data.message)}catch(e){d.Ay.error("Error al eliminar el producto")}},{getRootProps:Z,getInputProps:Y,isDragActive:K}=(0,u.VB)({onDrop:e=>{let a=e[0];if(a){let e=new FileReader;e.onload=e=>{try{let a=new Uint8Array(e.target.result),t=m.LF(a,{type:"array"}),r=t.SheetNames[0],s=t.Sheets[r],o=m.Wp.sheet_to_json(s,{header:1}).slice(1).map((e,a)=>{if(e.length>=6){let t=1;if(e[4]&&""!==e[4]){let a=parseInt(e[4]);!isNaN(a)&&a>0&&(t=a)}return{id:"temp_".concat(a),code:e[0]||"",name:e[1]||"",price:e[2]||0,offerPrice:e[3]||0,minWholesaleQuantity:t,category:e[5]||"Sin categor\xeda",brand:e[6]||"Sin marca",description:e[7]||"Producto importado desde Excel",image:""}}return null}).filter(e=>null!==e);P(o),A(!0),d.Ay.success("Archivo cargado: ".concat(o.length," productos encontrados"))}catch(e){d.Ay.error("Error al procesar el archivo Excel"),console.error("Error:",e)}},e.readAsArrayBuffer(a)}},accept:{"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":[".xlsx"],"application/vnd.ms-excel":[".xls"],"text/csv":[".csv"]},multiple:!1}),X=async()=>{_(!0);try{let e=[];for(let a of E){let r=t.find(e=>e.name.toLowerCase()===a.name.toLowerCase()||e.code===a.code);r&&e.push({name:a.name,existing:r.name})}if(e.length>0){let a=e.map(e=>e.name).join(", "),t="Se encontraron ".concat(e.length," productos que ya existen: ").concat(a,". \xbfDeseas actualizar estos productos existentes?");if(!confirm(t)){_(!1);return}}let a=E.map(e=>({name:e.name,code:e.code||"",category:e.category,brand:e.brand||"Sin marca",price:parseFloat(e.price)||0,offerPrice:parseFloat(e.offerPrice)||0,minWholesaleQuantity:e.minWholesaleQuantity,description:e.description||"",image:e.image||""})),{data:r}=await i.A.post("/api/product/import",{products:a},{withCredentials:!0});r.success?(d.Ay.success(r.message),A(!1),P([]),$()):d.Ay.error(r.message)}catch(e){d.Ay.error("Error al importar productos"),console.error("Error:",e)}finally{_(!1)}},ee=e=>{Q(a=>a.includes(e)?a.filter(a=>a!==e):[...a,e])},ea=e=>[...new Set(e.map(e=>e.categoryName||e.category))].sort(),et=()=>{let e=t;if(D.trim()){let a=D.toLowerCase();e=e.filter(e=>e.name.toLowerCase().includes(a)||e.description.toLowerCase().includes(a)||(e.categoryName||e.category).toLowerCase().includes(a)||e.price.toString().includes(a)||e.offerPrice.toString().includes(a))}return U&&(e=e.filter(e=>(e.categoryName||e.category)===U)),e},er=()=>{let e=et(),a=(W-1)*G;return e.slice(a,a+G)};(0,s.useEffect)(()=>{$(),es()},[]);let es=async()=>{try{let{data:e}=await i.A.get("/api/brands");e.success&&R(e.brands)}catch(e){console.log("Error al cargar marcas:",e)}};return(0,s.useEffect)(()=>{t.length>0&&B(ea(t))},[t]),(0,s.useEffect)(()=>{F(1)},[D,U]),(0,r.jsx)("div",{className:"flex-1 min-h-screen flex flex-col justify-between",children:g?(0,r.jsx)("div",{className:"flex-1 flex items-center justify-center",children:(0,r.jsx)(n.A,{})}):(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{className:"w-full md:p-10 p-4",children:[(0,r.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-6",children:[(0,r.jsx)("h2",{className:"text-lg font-medium",children:"Gesti\xf3n de Productos"}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)("button",{onClick:()=>{let e=m.Wp.aoa_to_sheet([["C\xf3digo","Nombre","Precio","Precio Mayorista","Cantidad M\xednima Mayorista","Categor\xeda","Marca","Descripci\xf3n"],["","iPhone 15 Pro","1200","1100","5","Smartphones","Apple","iPhone 15 Pro 256GB"],["","Samsung Galaxy S24","1000","900","3","Smartphones","Samsung","Samsung Galaxy S24 128GB"],["","MacBook Air M2","1500","1350","2","Laptops","Apple","MacBook Air M2 13 pulgadas"],["","AirPods Pro","250","220","10","Auriculares","Apple","AirPods Pro 2da generaci\xf3n"],["","iPad Air","600","550","5","Tablets","Apple","iPad Air 10.9 pulgadas"]]);e["!cols"]=[{wch:15},{wch:20},{wch:12},{wch:15},{wch:20},{wch:15},{wch:15},{wch:30}];let a=m.Wp.book_new();m.Wp.book_append_sheet(a,e,"Plantilla Productos"),m._h(a,"plantilla_productos_abudicell.xlsx"),d.Ay.success("Plantilla descargada exitosamente")},className:"px-3 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 flex items-center gap-2",children:[(0,r.jsx)(p.E5v,{size:16}),"Descargar Plantilla"]}),(0,r.jsxs)("button",{onClick:()=>{let e=et(),a=e.map(e=>[e._id,e.name,e.price,e.offerPrice,e.minWholesaleQuantity||1,e.categoryName||e.category,e.brandName||e.brand||"Sin marca",e.description]),t=m.Wp.aoa_to_sheet([["C\xf3digo","Nombre","Precio","Precio Mayorista","Cantidad M\xednima Mayorista","Categor\xeda","Marca","Descripci\xf3n"],...a]),r=m.Wp.book_new();m.Wp.book_append_sheet(r,t,"Productos"),m._h(r,"productos_filtrados_".concat(new Date().toISOString().split("T")[0],".xlsx")),d.Ay.success("".concat(e.length," productos exportados exitosamente"))},className:"px-3 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 flex items-center gap-2",children:[(0,r.jsx)(p.vpy,{size:16}),"Exportar Filtrados"]}),L.length>0&&(0,r.jsxs)("button",{onClick:()=>{let e=L.length>0?t.filter(e=>L.includes(e._id)):er();if(0===e.length){d.Ay.error("No hay productos para exportar");return}let a=e.map(e=>({Código:e.code||"",Nombre:e.name,Precio:e.price,"Precio Mayorista":e.offerPrice,"Cantidad M\xednima":e.minWholesaleQuantity||1,Categoría:e.categoryName||e.category,Marca:e.brandName||e.brand,Descripción:e.description})),r=m.Wp.json_to_sheet(a),s=m.Wp.book_new();m.Wp.book_append_sheet(s,r,"Productos Exportados");let o=L.length>0?"productos_seleccionados_".concat(new Date().toISOString().split("T")[0],".xlsx"):"productos_filtrados_".concat(new Date().toISOString().split("T")[0],".xlsx");m._h(s,o),d.Ay.success("".concat(e.length," productos exportados exitosamente"))},className:"px-3 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 flex items-center gap-2",children:[(0,r.jsx)(p.vpy,{size:16}),"Exportar Seleccionados (",L.length,")"]}),(0,r.jsxs)("button",{onClick:()=>A(!0),className:"px-3 py-2 bg-[#feecaf] text-black rounded-md hover:bg-[#feecaf]/80 flex items-center gap-2",children:[(0,r.jsx)(p.E5v,{size:16}),"Importar Excel"]})]})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-4 mb-6",children:[(0,r.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,r.jsx)("div",{className:"flex-1",children:(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(p.gZ7,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),(0,r.jsx)("input",{type:"text",placeholder:"Buscar productos por nombre, descripci\xf3n, categor\xeda o precio...",value:D,onChange:e=>M(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-[#feecaf] focus:border-transparent outline-none"})]})}),(0,r.jsx)("div",{className:"md:w-64",children:(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(p.uJN,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),(0,r.jsxs)("select",{value:U,onChange:e=>I(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-[#feecaf] focus:border-transparent outline-none appearance-none bg-white",children:[(0,r.jsx)("option",{value:"",children:"Todas las categor\xedas"}),T.map(e=>(0,r.jsx)("option",{value:e,children:e},e))]})]})}),(D||U)&&(0,r.jsx)("button",{onClick:()=>{M(""),I(""),F(1)},className:"px-4 py-2 text-gray-600 hover:text-gray-800 border border-gray-300 rounded-md hover:bg-gray-50 transition-colors",children:"Limpiar"})]}),(0,r.jsxs)("div",{className:"mt-4 flex items-center justify-between text-sm text-gray-600",children:[(0,r.jsxs)("div",{children:["Mostrando ",er().length," de ",et().length," productos",et().length!==t.length&&(0,r.jsxs)("span",{className:"ml-2 text-blue-600",children:["(filtrados de ",t.length," total)"]})]}),(0,r.jsxs)("div",{children:["P\xe1gina ",W," de ",Math.ceil(et().length/G)||1]})]})]}),(0,r.jsx)("div",{className:"flex flex-col items-center max-w-6xl w-full rounded-md bg-white border border-gray-500/20 overflow-hidden",children:(0,r.jsx)("div",{className:"w-full overflow-x-auto",children:(0,r.jsxs)("table",{className:"min-w-full table-auto",children:[(0,r.jsx)("thead",{className:"text-gray-900 text-sm text-left bg-gray-50",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"px-4 py-3 font-medium whitespace-nowrap min-w-[50px]",children:(0,r.jsx)("input",{type:"checkbox",checked:z,onChange:()=>{z?(Q([]),q(!1)):(Q(er().map(e=>e._id)),q(!0))},className:"rounded border-gray-300 text-[#feecaf] focus:ring-[#feecaf]"})}),(0,r.jsx)("th",{className:"px-4 py-3 font-medium whitespace-nowrap min-w-[200px]",children:"Producto"}),(0,r.jsx)("th",{className:"px-4 py-3 font-medium whitespace-nowrap min-w-[120px]",children:"Categor\xeda"}),(0,r.jsx)("th",{className:"px-4 py-3 font-medium whitespace-nowrap min-w-[100px]",children:"Marca"}),(0,r.jsx)("th",{className:"px-4 py-3 font-medium whitespace-nowrap min-w-[100px]",children:"Precio"}),(0,r.jsx)("th",{className:"px-4 py-3 font-medium whitespace-nowrap min-w-[120px]",children:"Precio Mayorista"}),(0,r.jsx)("th",{className:"px-4 py-3 font-medium whitespace-nowrap min-w-[140px]",children:"Cant. M\xedn. Mayorista"}),(0,r.jsx)("th",{className:"px-4 py-3 font-medium whitespace-nowrap min-w-[120px]",children:"Acciones"})]})}),(0,r.jsx)("tbody",{className:"text-sm text-gray-500",children:er().map((a,t)=>(0,r.jsxs)("tr",{className:"border-t border-gray-500/20 hover:bg-gray-50",children:[(0,r.jsx)("td",{className:"px-4 py-3 whitespace-nowrap",children:(0,r.jsx)("input",{type:"checkbox",checked:L.includes(a._id),onChange:()=>ee(a._id),className:"rounded border-gray-300 text-[#feecaf] focus:ring-[#feecaf]"})}),(0,r.jsxs)("td",{className:"px-4 py-3 flex items-center space-x-3 whitespace-nowrap",children:[(0,r.jsx)("div",{className:"bg-gray-500/10 rounded p-2 w-20 h-20 flex items-center justify-center overflow-hidden",children:a.image&&a.image[0]?(0,r.jsx)(l.default,{src:a.image[0],alt:"product Image",className:"w-full h-full object-cover rounded",width:80,height:80}):(0,r.jsx)(l.default,{src:"/placeholder-product.jpeg",alt:"product Image",className:"w-full h-full object-cover rounded",width:80,height:80})}),(0,r.jsx)("span",{className:"font-medium",children:a.name})]}),(0,r.jsx)("td",{className:"px-4 py-3 whitespace-nowrap",children:a.categoryName||a.category}),(0,r.jsx)("td",{className:"px-4 py-3 whitespace-nowrap",children:a.brandName||a.brand||"Sin marca"}),(0,r.jsxs)("td",{className:"px-4 py-3 whitespace-nowrap",children:["$",a.price]}),(0,r.jsxs)("td",{className:"px-4 py-3 whitespace-nowrap",children:["$",a.offerPrice]}),(0,r.jsx)("td",{className:"px-4 py-3 whitespace-nowrap",children:void 0!==a.minWholesaleQuantity?a.minWholesaleQuantity:1}),(0,r.jsx)("td",{className:"px-4 py-3 whitespace-nowrap",children:(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsxs)("button",{onClick:()=>H(a),className:"flex items-center gap-1 px-2 py-1 bg-[#feecaf] text-black rounded-md hover:bg-[#feecaf]/80 transition-colors",children:[(0,r.jsx)(p.Yvo,{size:14}),(0,r.jsx)("span",{className:"hidden md:block",children:"Editar"})]}),(0,r.jsxs)("button",{onClick:()=>J(a._id),className:"flex items-center gap-1 px-2 py-1 bg-red-100 text-red-600 rounded-md hover:bg-red-200 transition-colors",children:[(0,r.jsx)(p.b6i,{size:14}),(0,r.jsx)("span",{className:"hidden md:block",children:"Eliminar"})]}),(0,r.jsxs)("button",{onClick:()=>e.push("/product/".concat(a._id)),className:"flex items-center gap-1 px-2 py-1 bg-green-100 text-green-600 rounded-md hover:bg-green-200 transition-colors",children:[(0,r.jsx)("span",{className:"hidden md:block",children:"Ver"}),(0,r.jsx)(l.default,{className:"h-3.5",src:o.mY.redirect_icon,alt:"redirect_icon"})]})]})})]},t))})]})})}),et().length>G&&(0,r.jsxs)("div",{className:"flex items-center justify-between mt-6 px-4",children:[(0,r.jsxs)("div",{className:"text-sm text-gray-600",children:["Mostrando ",(W-1)*G+1," a ",Math.min(W*G,et().length)," de ",et().length," productos"]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsxs)("button",{onClick:()=>F(e=>Math.max(e-1,1)),disabled:1===W,className:"flex items-center px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,r.jsx)(p.E_E,{size:16}),"Anterior"]}),(0,r.jsx)("div",{className:"flex space-x-1",children:Array.from({length:Math.ceil(et().length/G)},(e,a)=>a+1).filter(e=>{let a=Math.ceil(et().length/G);return 1===e||e===a||2>=Math.abs(e-W)}).map((e,a,t)=>{let o=a>0&&e-t[a-1]>1;return(0,r.jsxs)(s.Fragment,{children:[o&&(0,r.jsx)("span",{className:"px-2 py-1 text-gray-500",children:"..."}),(0,r.jsx)("button",{onClick:()=>F(e),className:"px-3 py-2 text-sm font-medium rounded-md ".concat(W===e?"bg-[#feecaf] text-black":"text-gray-500 bg-white border border-gray-300 hover:bg-gray-50"),children:e})]},e)})}),(0,r.jsxs)("button",{onClick:()=>F(e=>Math.min(e+1,Math.ceil(et().length/G))),disabled:W===Math.ceil(et().length/G),className:"flex items-center px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:["Siguiente",(0,r.jsx)(p.xVu,{size:16})]})]})]}),f&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,r.jsx)("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Editar Producto"}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nombre del Producto"}),(0,r.jsx)("input",{type:"text",value:b.name||"",onChange:e=>j({...b,name:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-[#feecaf] focus:border-transparent outline-none"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Categor\xeda"}),(0,r.jsx)("input",{type:"text",value:b.category||"",onChange:e=>j({...b,category:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-[#feecaf] focus:border-transparent outline-none"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Marca"}),(0,r.jsxs)("select",{value:b.brand||"",onChange:e=>j({...b,brand:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-[#feecaf] focus:border-transparent outline-none",children:[(0,r.jsx)("option",{value:"",children:"Seleccionar marca"}),O.map(e=>(0,r.jsx)("option",{value:e._id,children:e.name},e._id))]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Precio"}),(0,r.jsx)("input",{type:"number",value:b.price||"",onChange:e=>j({...b,price:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-[#feecaf] focus:border-transparent outline-none"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Precio Mayorista"}),(0,r.jsx)("input",{type:"number",value:b.offerPrice||"",onChange:e=>j({...b,offerPrice:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-[#feecaf] focus:border-transparent outline-none"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Cantidad M\xednima para Precio Mayorista"}),(0,r.jsx)("input",{type:"number",value:void 0!==b.minWholesaleQuantity?b.minWholesaleQuantity:"",onChange:e=>j({...b,minWholesaleQuantity:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-[#feecaf] focus:border-transparent outline-none"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Descripci\xf3n"}),(0,r.jsx)("textarea",{value:b.description||"",onChange:e=>j({...b,description:e.target.value}),rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-[#feecaf] focus:border-transparent outline-none"})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Im\xe1genes del Producto ",(0,r.jsx)("span",{className:"text-sm text-gray-500",children:"(opcional)"})]}),(0,r.jsx)("div",{className:"flex flex-wrap items-center gap-3 mt-2",children:[void 0,void 0,void 0,void 0].map((e,a)=>(0,r.jsxs)("label",{htmlFor:"editImage".concat(a),children:[(0,r.jsx)("input",{onChange:e=>{let t=[...N];t[a]=e.target.files[0],v(t)},type:"file",id:"editImage".concat(a),hidden:!0}),(0,r.jsx)("div",{className:"w-24 h-24 border-2 border-dashed border-gray-300 rounded-lg flex items-center justify-center cursor-pointer hover:border-[#feecaf] transition-colors",children:N[a]?(0,r.jsx)("img",{src:URL.createObjectURL(N[a]),alt:"Preview",className:"w-full h-full object-cover rounded-lg"}):(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("svg",{className:"w-6 h-6 text-gray-400 mx-auto mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),(0,r.jsx)("span",{className:"text-xs text-gray-500",children:"Agregar"})]})})]},a))}),b.image&&(0,r.jsxs)("div",{className:"mt-3",children:[(0,r.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:"Im\xe1genes actuales:"}),(0,r.jsx)("div",{className:"flex flex-wrap gap-2",children:b.image.split(",").map((e,a)=>e.trim()&&(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("img",{src:e.trim(),alt:"Imagen ".concat(a+1),className:"w-16 h-16 object-cover rounded border"}),(0,r.jsx)("button",{type:"button",onClick:()=>{let e=b.image.split(",").filter((e,t)=>t!==a);j({...b,image:e.join(", ")})},className:"absolute -top-1 -right-1 bg-red-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs hover:bg-red-600",children:"\xd7"})]},a))})]})]})]}),(0,r.jsxs)("div",{className:"flex justify-end gap-3 mt-6",children:[(0,r.jsxs)("button",{onClick:()=>{y(null),j({}),v([])},className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 flex items-center gap-2",children:[(0,r.jsx)(p.uDv,{size:16}),"Cancelar"]}),(0,r.jsxs)("button",{onClick:()=>V(f),className:"px-4 py-2 bg-[#feecaf] text-black rounded-md hover:bg-[#feecaf]/80 flex items-center gap-2",children:[(0,r.jsx)(p.rZB,{size:16}),"Guardar"]})]})]})})}),S&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,r.jsx)("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Importar Productos desde Excel"}),(0,r.jsxs)("div",{...Z(),className:"border-2 border-dashed rounded-lg p-8 text-center cursor-pointer transition-colors ".concat(K?"border-[#feecaf] bg-[#feecaf]/10":"border-gray-300 hover:border-[#feecaf] hover:bg-gray-50"),children:[(0,r.jsx)("input",{...Y()}),(0,r.jsx)(p.vpy,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),(0,r.jsx)("p",{className:"text-lg font-medium text-gray-900 mb-2",children:K?"Suelta el archivo aqu\xed":"Arrastra un archivo Excel aqu\xed"}),(0,r.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:"o haz click para seleccionar un archivo"}),(0,r.jsx)("p",{className:"text-xs text-gray-500",children:"Formatos soportados: .xlsx, .xls, .csv"})]}),(0,r.jsxs)("div",{className:"mt-6 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[(0,r.jsx)("h4",{className:"font-medium text-yellow-900 mb-2",children:"Formato esperado del archivo Excel:"}),(0,r.jsxs)("div",{className:"text-sm text-yellow-800",children:[(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Columna A:"})," C\xf3digo del producto"]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Columna B:"})," Nombre del producto"]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Columna C:"})," Precio"]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Columna D:"})," Precio mayorista"]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Columna E:"})," Cantidad m\xednima para precio mayorista"]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Columna F:"})," Categor\xeda"]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Columna G:"})," Marca"]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Columna H:"})," Descripci\xf3n"]}),(0,r.jsx)("p",{className:"mt-2 text-xs",children:"La primera fila debe contener los encabezados. Los datos deben empezar desde la fila 2."})]})]}),E.length>0&&(0,r.jsxs)("div",{className:"mt-6",children:[(0,r.jsxs)("h4",{className:"font-medium text-gray-900 mb-3",children:["Vista previa de datos (",E.length," productos):"]}),(0,r.jsx)("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:(0,r.jsxs)("div",{className:"overflow-x-auto max-h-60",children:[(0,r.jsxs)("table",{className:"w-full text-sm",children:[(0,r.jsx)("thead",{className:"bg-gray-50",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"px-3 py-2 text-left font-medium text-gray-900",children:"C\xf3digo"}),(0,r.jsx)("th",{className:"px-3 py-2 text-left font-medium text-gray-900",children:"Nombre"}),(0,r.jsx)("th",{className:"px-3 py-2 text-left font-medium text-gray-900",children:"Precio"}),(0,r.jsx)("th",{className:"px-3 py-2 text-left font-medium text-gray-900",children:"Precio Mayorista"}),(0,r.jsx)("th",{className:"px-3 py-2 text-left font-medium text-gray-900",children:"Cant. M\xedn. Mayorista"}),(0,r.jsx)("th",{className:"px-3 py-2 text-left font-medium text-gray-900",children:"Categor\xeda"}),(0,r.jsx)("th",{className:"px-3 py-2 text-left font-medium text-gray-900",children:"Marca"})]})}),(0,r.jsx)("tbody",{className:"divide-y divide-gray-200",children:E.slice(0,10).map((e,a)=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{className:"px-3 py-2 text-gray-600",children:e.code}),(0,r.jsx)("td",{className:"px-3 py-2 text-gray-600",children:e.name}),(0,r.jsxs)("td",{className:"px-3 py-2 text-gray-600",children:["$",e.price]}),(0,r.jsxs)("td",{className:"px-3 py-2 text-gray-600",children:["$",e.offerPrice]}),(0,r.jsx)("td",{className:"px-3 py-2 text-gray-600",children:e.minWholesaleQuantity}),(0,r.jsx)("td",{className:"px-3 py-2 text-gray-600",children:e.category}),(0,r.jsx)("td",{className:"px-3 py-2 text-gray-600",children:e.brand})]},a))})]}),E.length>10&&(0,r.jsxs)("div",{className:"px-3 py-2 text-sm text-gray-500 bg-gray-50",children:["... y ",E.length-10," productos m\xe1s"]})]})})]}),(0,r.jsxs)("div",{className:"flex justify-end gap-3 mt-6",children:[(0,r.jsxs)("button",{onClick:()=>{A(!1),P([])},className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 flex items-center gap-2",children:[(0,r.jsx)(p.uDv,{size:16}),"Cancelar"]}),E.length>0&&(0,r.jsx)("button",{onClick:X,disabled:k,className:"px-4 py-2 bg-[#feecaf] text-black rounded-md hover:bg-[#feecaf]/80 flex items-center gap-2 disabled:opacity-50",children:k?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-black"}),"Importando..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(p.rZB,{size:16}),"Importar ",E.length," Productos"]})})]})]})})})]})})})}},1598:(e,a,t)=>{"use strict";t.d(a,{A:()=>s});var r=t(5155);t(2115);let s=()=>(0,r.jsx)("div",{className:"flex justify-center items-center h-[70vh]",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-20 w-20 border-4 border-t-[#feecaf] border-gray-200"})})},3805:(e,a,t)=>{"use strict";t.d(a,{AppContextProvider:()=>m,U:()=>d});var r=t(5155),s=t(2615),o=t(2651),l=t(6046),c=t(2115),n=t(5037);let i=(0,c.createContext)(),d=()=>(0,c.useContext)(i),m=e=>{let a=(0,l.useRouter)(),{data:t,status:d}=(0,s.useSession)(),m=null==t?void 0:t.user,u=async()=>{try{if(!t)return console.log("No hay sesi\xf3n activa"),null;return"authenticated"}catch(e){return console.error("Error getting token:",e),null}},[p,x]=(0,c.useState)([]),[g,h]=(0,c.useState)([]),[f,y]=(0,c.useState)(!1),[b,j]=(0,c.useState)(!1),[N,v]=(0,c.useState)({}),[w,C]=(0,c.useState)(!0),E=async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];try{if(C(!0),!e){let e=localStorage.getItem("quickcart_products"),a=localStorage.getItem("quickcart_products_timestamp");if(e&&a&&Date.now()-parseInt(a)<6e5){console.log("\uD83D\uDCE6 Cargando productos desde localStorage"),x(JSON.parse(e)),C(!1),P();return}}await P()}catch(e){console.error("Error loading products:",e),n.Ay.error("Error al cargar productos"),C(!1)}},P=async()=>{try{console.log("\uD83C\uDF10 Cargando productos desde Atlas (API)");let{data:e}=await o.A.get("/api/product/list",{timeout:1e4});if(e.success){let a=e.products.map(e=>({...e,minQuantity:e.minWholesaleQuantity&&e.minWholesaleQuantity>0?e.minWholesaleQuantity:1,image:e.image&&e.image.length>0&&e.image[0]&&""!==e.image[0]?e.image:["/placeholder-product.jpeg"]}));x(a),setTimeout(()=>{localStorage.setItem("quickcart_products",JSON.stringify(a)),localStorage.setItem("quickcart_products_timestamp",Date.now().toString()),console.log("\uD83D\uDCBE Productos guardados en localStorage (Atlas)")},0)}else n.Ay.error(e.message)}catch(e){console.error("Error fetching products from Atlas API:",e),n.Ay.error("Error al cargar productos desde Atlas")}finally{C(!1)}},S=async()=>{try{let{data:e}=await o.A.get("/api/categories");e.success&&h(e.categories)}catch(e){console.error("Error fetching categories:",e)}},A=async()=>{try{if(console.log("\uD83D\uDD0D [FRONTEND DEBUG] Iniciando fetchUserData..."),console.log("\uD83D\uDD0D [FRONTEND DEBUG] Usuario de NextAuth:",m?{id:m.id,email:m.email,role:m.role}:"No hay usuario"),!m){console.log("❌ [FRONTEND DEBUG] No hay usuario autenticado");return}console.log("\uD83D\uDD0D [FRONTEND DEBUG] Haciendo petici\xf3n a /api/user/data...");let{data:e}=await o.A.get("/api/user/data");console.log("\uD83D\uDD0D [FRONTEND DEBUG] Respuesta del servidor:",e),e.success?(console.log("✅ [FRONTEND DEBUG] Usuario encontrado exitosamente en la base de datos"),y(e.user),v(e.user.cartItems)):(console.log("❌ [FRONTEND DEBUG] Error del servidor:",e.message),n.Ay.error(e.message))}catch(e){console.log("❌ [FRONTEND DEBUG] Error en fetchUserData:",e.message),console.log("\uD83D\uDD0D [FRONTEND DEBUG] Error completo:",e),n.Ay.error(e.message)}},k=async e=>{if(!m)return(0,n.Ay)("Please login",{icon:"⚠️"});let a=structuredClone(N);if(a[e]?a[e]+=1:a[e]=1,v(a),m)try{await o.A.post("/api/cart/update",{cartData:a}),n.Ay.success("Item added to cart")}catch(e){n.Ay.error(e.message)}},_=async(e,a)=>{let t=structuredClone(N);if(0===a?delete t[e]:t[e]=a,v(t),m)try{await o.A.post("/api/cart/update",{cartData:t}),n.Ay.success("Cart Updated")}catch(e){n.Ay.error(e.message)}};(0,c.useEffect)(()=>{E(),S()},[]),(0,c.useEffect)(()=>{console.log("\uD83D\uDD0D [FRONTEND DEBUG] useEffect ejecutado - usuario cambi\xf3:",m?{id:m.id,email:m.email,role:m.role}:"No hay usuario"),m?(console.log("\uD83D\uDD0D [FRONTEND DEBUG] Usuario detectado, llamando fetchUserData..."),A()):(console.log("\uD83D\uDD0D [FRONTEND DEBUG] No hay usuario, limpiando datos..."),y(!1),j(!1),v({}))},[m]);let D={user:m,signOut:s.signOut,getToken:u,currency:"$",router:a,isSeller:b,setIsSeller:j,userData:f,fetchUserData:A,products:p,fetchProductData:E,categories:g,fetchCategories:S,getCategoryName:e=>{if(!e||!g.length)return"Sin categor\xeda";let a=g.find(a=>a._id===e);return a?a.name:"Sin categor\xeda"},updateProductRating:(e,a,t)=>{x(r=>r.map(r=>r._id===e?{...r,averageRating:a,totalRatings:t}:r))},isLoadingProducts:w,cartItems:N,setCartItems:v,addToCart:k,updateCartQuantity:_,getCartCount:()=>{let e=0;for(let a in N)N[a]>0&&(e+=N[a]);return e},getCartAmount:()=>{let e=0;for(let a in N){let t=p.find(e=>e._id===a);if(N[a]>0&&t){let r=t.minQuantity&&t.minQuantity>0?t.minQuantity:1;e+=(N[a]>=r?t.offerPrice:t.price)*N[a]}}return Math.floor(100*e)/100},generateCartShareUrl:()=>{let e=Object.entries(N).filter(e=>{let[a,t]=e;return t>0});if(0===e.length)return null;let a=e.map(e=>{let[a,t]=e;return"".concat(a,":").concat(t)}).join(",");return"".concat(window.location.origin,"/cart?products=").concat(encodeURIComponent(a))}};return(0,r.jsx)(i.Provider,{value:D,children:e.children})}}},e=>{var a=a=>e(e.s=a);e.O(0,[5479,3524,5037,2651,3060,5565,6308,6962,8441,1517,7358],()=>a(7347)),_N_E=e.O()}]);